rgcThickness = [58.0788	60.4721	54.594	63.9186	63.8548	63.5953	55.4305	56.5193	59.7724	52.3976	48.6379	57.2812	52.4294	54.296	66.4505	55.9349	54.7936	57.064	58.0639	64.982	58.0671	50.7513	56.985	59.5601	60.6011	65.1579	58.6377	60.4926	58.6846	54.7035	56.8951	68.3222	55.0445	57.0009	66.287	53.4684	58.4141	62.4132	56.4051];

Xintercept = [1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1	1];
Xage = [29.16084873	33.18275154	25.56605065	30.7926078	19.25804244	32.82956879	21.58247775	26.71868583	29.08145106	61.45927447	24.24640657	24.26830938	20.19712526	25.66461328	20.31759069	26.7980835	25.72758385	27.15674196	47.57563313	19.14031485	20.42984257	19.13483915	32.23271732	26.97878166	25.38809035	26.24229979	32.0054757	32.28199863	28.77754962	28.45448323	26.16837782	26.23408624	26.93223819	38.95140315	18.48049281	21.08692676	18.83915127	36.13415469	25.02395619];
XaxialLength = [24.575	25.52	27.25	23.99	22.685	22.265	25.925	24.955	23.955	24.91	27.57	24.965	23.47	22.775	22.895	24.75	25.365	25.34	27.63	22.62	26.51	25.63	24.185	25.53	23.305	22.48	22.77	24.005	23.625	23.63	23.945	24.43	25.685	23.51	22.165	22.055	24.205	21.785	24.93];
Xsupratentorial = [1.176680726	1.385642745	1.036681388	1.223282217	0.97513766	1.083823539	0.996297953	1.102104174	1.025917597	0.952208114	0.878825359	1.134576467	0.960522282	0.963969964	1.002350016	1.167647853	0.990180887	1.326902136	1.047725088	1.148778893	1.225751712	0.971956337	1.021276517	1.130790959	1.05035131	0.959265967	1.217016543	0.991620094	1.134202706	1.126006732	1.031029951	1.330919749	0.99474669	0.994068813	0.986438879	1.068524838	0.979944601	1.143455848	1.158639164];
Xchiasm = [234.7	332	332.9	283.2	212.2	274.7	296.9	238	265.7	291.5	222.6	247.9	172.2	198.6	224.7	247.3	232.6	301.7	285.2	279.7	302.9	280.8	187.1	292.5	299.6	238.6	304.2	343.9	282	276.9	295.1	464.3	262.7	245.2	266.1	265.3	272.6	206.7	298.4];
Xlgn = [0.96815	0.900816	0.915694	0.985031	1.095282	1.026582	1.218479	0.923483	1.007515	1.131077	0.742497	0.924552	1.07719	0.836914	1.142009	0.989872	1.050252	0.949261	0.956047	0.94128	0.954403	0.909608	1.123828	0.898999	0.96203	1.016038	0.802903	1.100074	0.977902	1.049302	0.903138	1.218781	1.113504	0.941462	0.84548	0.933426	0.976494	0.995076	0.887255];
Xv1area = [3091	3659.5	3567.5	3096	2813	3381	3198	3196.5	2990.5	2680	2378	3425	2759.5	3035	2819	3276.5	3037	3204	3237.5	3605.5	3378	2352	3737	3231	2767.5	2772.5	3375.5	2991.5	3073.5	3556.5	3001	3747.5	2823.5	2691	2624.5	3390	2996	3295	2901.5];
Xv1thickness = [1.865	1.7275	1.7635	1.4955	1.7105	1.551	1.633	1.7425	1.6085	1.7315	1.637	1.759	1.667	1.7135	1.761	1.8915	1.774	1.7535	1.6305	1.6265	2.0045	1.6955	1.618	1.5685	1.5895	1.8845	1.7455	1.824	1.629	1.506	1.7295	1.8055	1.717	1.689	1.5845	1.4985	1.8585	1.639	1.737];

y = rgcThickness;
XReduced = [Xintercept; Xage ];
XFull = [XReduced; XaxialLength ];

nBoot = 10000;
for bb = 1:nBoot
    boot = randsample(1:39,39,true);
    [~,~,~,~,statsReduced] = regress(y(boot)',XReduced(:,boot)');
    [~,~,~,~,statsFull] = regress(y(boot)',XFull(:,boot)');
    wins(bb) = statsFull(3) < statsReduced(3);
    explained(bb) = statsFull(1) - statsReduced(1);
end

sortExplained = sort(explained);

fprintf('p-value: %f \n',1-sum(wins)/nBoot)
fprintf('variance explained [±quartile]: %f [%f] \n',mean(explained),mean([mean(explained)-sortExplained(round(nBoot*0.25)),sortExplained(round(nBoot*0.75))-mean(explained)]))

% [y,E] = histcounts(explained);
% deltaE=diff(E);
% x = E(1:end-1)+deltaE(1);
% p0 = [max(explained),0,0.1];
% f = fit(x',y','gauss1','StartPoint',p0);
% plot(f,x,y)
